---
title: "<Draft> Lab3: Reducing Crime"
output: pdf_document
---

# Exploratory Data Analysis

Perform an exploratory analysis to understand how campaign characteristics are related to the candidate's debt. 

## Setup

First, we load the necessary libraries.

```{r library}
library(stargazer)
```

Then we load the dataset, which is in the same directory as this RMD.

```{r data}
# Load the data 
rawCrimeData = read.csv("crime_v2.csv")
View(rawCrimeData)
str(rawCrimeData)
```

The dataset contains 25 columns (variables) and 97 rows

## Data Quality/Clean-up

```{r }
apply(!is.na(rawCrimeData[,]), MARGIN = 2, mean)
```

the dataset contains few NA that we'll need to fix before proceeding further. 

```{r }
complete.cases(rawCrimeData)
crimeData <- rawCrimeData[complete.cases(rawCrimeData), ]
apply(!is.na(crimeData[,]), MARGIN = 2, mean)
```

now we're good to go.

## Univariate Variable Analysis of Key Variables

### crmrte: crimes committed per person

Looking at the histogram of crime per person, the distribution appear to be positelvey skewed. Applying `log()` on crime shows the histogram to appear normally distributed.

```{r }
hist(crimeData$crmrte, breaks=20, main = "Crimes Committed per Person")
hist(log(crimeData$crmrte), breaks=20, main = "Crimes Committed per Person")
```

### prbarr: probability of arrest

Looking at the histogram of arrest per person, the distribution appear to be positelvey skewed. Applying `log()` shows the histogram to appear *less* normally distributed.

```{r }
hist(crimeData$prbarr, breaks=20, main = "probability of Arrest per Person")
hist(log(crimeData$prbarr), breaks=20, main = "Probability of Arrest per Person")
```

### prbconv: probability of conviction

First, we'll need to concert the field from Factor to numeric for further analysis. Looking at the histogram of probability of conviction, the distribution appear to be positelvey skewed. Applying `log()` shows the histogram to appear normally distributed.

```{r }
crimeData$prbconv <- as.numeric(as.character(crimeData$prbconv))
hist(crimeData$prbconv, breaks=20, main = "Probability of conviction")
hist(log(crimeData$prbconv), breaks=20, main = "Probability of conviction")
```

### prbpris: of prison sentence

Looking at the histogram of probability of sentence, the distribution appear to be relatively normal. Applying `log()` shows the histogram to appear *less* normally distributed.

```{r }
hist(crimeData$prbpris, breaks=20, main = "Probability of sentence")
hist(log(crimeData$prbpris), breaks=20, main = "Probability of sentence")
```

### avgsen: avg. sentence, days

Looking at the histogram of probability of sentence, the distribution appear to be positevely skewed. Applying `log()` shows the histogram to appear *more* normally distributed.

```{r }
hist(crimeData$avgsen, breaks=20, main = "avg. sentence in days")
hist(log(crimeData$avgsen), breaks=20, main = "avg. sentence in days")
```

### polpc: police per capita

Looking at the histogram of probability of sentence, the distribution appear to be positevely skewed. Applying `log()` shows the histogram to appear *more* normally distributed.

```{r }
hist(crimeData$polpc, breaks=20, main = "police per capita")
hist(log(crimeData$polpc), breaks=20, main = "police per capita")
```

### density: people per sq. mile

Looking at the histogram of probability of sentence, the distribution appear to be positevely skewed. Applying `log()` shows the histogram to appear *more* normally distributed, with one outlier.

```{r }
hist(crimeData$density, breaks=20, main = "people per sq. mile")
hist(log(crimeData$density), breaks=20, main = "people per sq. mile")
```

### taxpc: tax revenue per capita

Looking at the histogram of probability of sentence, the distribution appear to be positevely skewed. Applying `log()` shows the histogram to appear slightly positevely skewed.

```{r }
hist(crimeData$taxpc, breaks=20, main = "tax revenue per capita")
hist(log(crimeData$taxpc), breaks=20, main = "tax revenue per capita")
```

### taxpc: tax revenue per capita

Looking at the histogram of probability of sentence, the distribution appear to be positevely skewed. Applying `log()` shows the histogram to appear slightly positevely skewed.

```{r }
barplot(c(sum(crimeData$urban), sum(crimeData$west), sum(crimeData$central)),
names.arg = c("Urban", "West", "Central"), main = "Part of the state counties are in")
```

### pctmin80: perc. minority, 1980

Looking at the histogram of probability of sentence, the distribution appear to be slightly positevely skewed. Applying `log()` shows the histogram to appear negatively skewed.

```{r }
hist(crimeData$pctmin80, breaks=20, main = "perc. minority")
hist(log(crimeData$pctmin80), breaks=20, main = "perc. minority")
```

### wcon: weekly wage, construction

Looking at the histogram of probability of sentence, the distribution appear to be slightly positevely skewed. Applying `log()` shows the histogram to appear normally distributed

```{r }
hist(crimeData$wcon, breaks=20, main = "Weekly wage")
hist(log(crimeData$wcon), breaks=20, main = "Weekly wage")
```

### wtuc: wkly wge, trns, util, commun

Looking at the histogram, the distribution appear to be normally distribbuted.

```{r }
hist(crimeData$wtuc, breaks=20)
```

### wtrd: wkly wge, whlesle, retail trade

Looking at the histogram, the distribution appear to be positvely skewed. Applying `log()` shows the histogram to appear normally distributed

```{r }
hist(crimeData$wtrd, breaks=20)
hist(log(crimeData$wtrd), breaks=20)
```

### wfir: wkly wge, fin, ins, real est

Looking at the histogram, the distribution appear to be normally distribbuted.

```{r }
hist(crimeData$wfir, breaks=20)
```

### wser: wkly wge, service industry

Looking at the histogram, the distribution appear to be positvely skewed. Applying `log()` shows the histogram to appear normally distributed with one outlier.

```{r }
hist(crimeData$wser, breaks=20)
hist(log(crimeData$wser), breaks=20)
```

### wmfg: wkly wge, manufacturing

Looking at the histogram, the distribution appear to be slighly positvely skewed. Applying `log()` shows the histogram to appear normally distributed.

```{r }
hist(crimeData$wmfg, breaks=20)
hist(log(crimeData$wmfg), breaks=20)
```

### wfed: wkly wge, fed employees

Applying `log()` shows the histogram to appear normally distributed.

```{r }
hist(crimeData$wfed, breaks=20)
hist(log(crimeData$wfed), breaks=20)
```

### wsta: wkly wge, state employees

Looking at the histogram, the distribution appear to be slighly positvely skewed. Applying `log()` shows the histogram to appear normally distributed.

```{r }
hist(crimeData$wsta, breaks=20)
hist(log(crimeData$wsta), breaks=20)
```

### wloc: wkly wge, state employees

Looking at the histogram, the distribution appear to be slighly normally distributed.

```{r }
hist(crimeData$wloc, breaks=20)
```

### mix: offense mix: face-to-face/other

Looking at the histogram, the distribution appear to be slighly positvely skewed. Applying `log()` shows the histogram to appear normally distributed.

```{r }
hist(crimeData$mix, breaks=20)
hist(log(crimeData$mix), breaks=20)
```

### pctymle: percent young male

Looking at the histogram, the distribution appear to be positvely skewed. Applying `log()` shows the histogram to appear positvely skewed with one outlier.

```{r }
hist(crimeData$pctymle, breaks=20)
hist(log(crimeData$pctymle), breaks=20)
```

## Analysis of Key Relationships

### Crimes Committed per person (crmrte) & People per sq. (density)

```{r }
plot(log(crimeData$density), log(crimeData$crmrte), 
    main="Crime Density vs Crime Rate", 
    xlab="People per sq",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ log(crimeData$density)))
cor(crimeData$crmrte, crimeData$density)
```

### Crimes Committed per person (crmrte) & Police per capita (polpc)

```{r }
plot(log(crimeData$polpc), log(crimeData$crmrte), 
    main="Crime Density vs Young Male", 
    xlab="Poilice per capita",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ log(crimeData$polpc)))
cor(crimeData$crmrte, crimeData$polpc)
```



### Crimes Committed per person (crmrte) & Perfect of Young Male (pctymle)

```{r }
plot(log(crimeData$pctymle), log(crimeData$crmrte), 
    main="Crime Density vs Young Male", 
    xlab="Young Male",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ log(crimeData$pctymle)))
cor(crimeData$crmrte, crimeData$pctymle)
```

### Crimes Committed per person (crmrte) & Wages

```{r }
plot(crimeData$wcon, log(crimeData$crmrte), 
    main="Wekly Wages (trns, util, commun) vs Crime Rate", 
    xlab="Wekly Wages",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ crimeData$wcon))

plot(log(crimeData$wtrd), log(crimeData$crmrte), 
    main="Wekly Wages (whlesle, retail trade) vs Crime Rate", 
    xlab="Wekly Wages",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ log(crimeData$wtrd)))

plot(crimeData$wfir, log(crimeData$crmrte), 
    main="Wekly Wages (fin, ins, real est) vs Crime Rate", 
    xlab="Wekly Wages",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ crimeData$wfir))

plot(log(crimeData$wser), log(crimeData$crmrte), 
    main="Wekly Wages (service industry) vs Crime Rate", 
    xlab="Wekly Wages",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ log(crimeData$wser)))

plot(log(crimeData$wmfg), log(crimeData$crmrte), 
    main="Wekly Wages (manufacturing) vs Crime Rate", 
    xlab="Wekly Wages",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ log(crimeData$wmfg)))

plot(log(crimeData$wfed), log(crimeData$crmrte), 
    main="Wekly Wages (fed employees) vs Crime Rate", 
    xlab="Wekly Wages",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ log(crimeData$wfed)))

plot(crimeData$wsta, log(crimeData$crmrte), 
    main="Wekly Wages (state employees) vs Crime Rate", 
    xlab="Wekly Wages",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ crimeData$wsta))

plot(log(crimeData$wloc), log(crimeData$crmrte), 
    main="Wekly Wages (local gov emps) vs Crime Rate", 
    xlab="Wekly Wages",
    ylab="Crimes Committed per person")
abline(lm(log(crimeData$crmrte) ~ log(crimeData$wloc)))
```

# Proposed Models

## Model#1: with only the explanatory variables

$$crimeDeterm = \beta_0 + \beta_1 \cdot log(density) + \beta_2 \cdot log(prbarr) + \beta_3 \cdot log(prbconv) + \beta_4 \cdot log(mix) + \beta_5 \cdot log(pctymle)$$

```{r model1}
model1 <- lm(log(crmrte) ~ log(density) + log(prbarr) + log(prbconv) + log(mix) + log(pctymle), data=crimeData)
summary(model1)
plot(model1)
```

## Model#2: with key explanatory variables and only covariates

$$crimeDeterm = \beta_0 + \beta_1 \cdot log(density) + \beta_2 \cdot log(prbarr) + \beta_3 \cdot log(prbconv) + \beta_4 \cdot log(mix) + \beta_5 \cdot log(pctymle) + \beta_6 \cdot log(polpc)$$

```{r model2}
model2 <- lm(log(crmrte) ~ log(density) + log(prbarr) + log(prbconv) + log(mix) + log(pctymle) + log(polpc), data=crimeData)
summary(model2)
plot(model2)
```


## Model#3: includes the previous covariates, and most, if not all, other covariates

